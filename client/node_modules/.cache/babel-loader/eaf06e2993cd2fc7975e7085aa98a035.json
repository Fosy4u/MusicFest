{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\FosterOgwudu\\\\Desktop\\\\MyProjects\\\\MusicFest\\\\client\\\\src\\\\components\\\\Dashboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useStateValue } from '../utilities/StateProvider';\nimport axios from 'axios';\nimport { useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Dashboard({\n  code\n}) {\n  _s();\n\n  const history = useHistory();\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  useEffect(() => {\n    console.log('code is', code);\n    axios.post('http://localhost:3001/login', {\n      code\n    }).then(res => {\n      console.log('res :', res);\n      setAccessToken(res.accessToken);\n      setRefreshToken(res.refreshToken);\n      setExpiresIn(res.expiresIn);\n      history.push('/');\n    }).catch(() => {\n      history.push('/');\n    });\n  }, [code]);\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const timeOut = setTimeout(() => {\n      axios.post('http://localhost:3001/refresh', {\n        refreshToken\n      }).then(res => {\n        console.log('res :', res);\n        setAccessToken(res.accessToken);\n        setExpiresIn(res.expiresIn);\n        history.push('/');\n      }).catch(() => {\n        history.push('/');\n      });\n    }, (expiresIn - 60) * 1000);\n    return;\n  }, [refreshToken, expiresIn]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Dashboard, \"sP1I0iMqO+5cVc3Vu0M9i1MzhJA=\", false, function () {\n  return [useHistory];\n});\n\n_c = Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"sources":["C:/Users/FosterOgwudu/Desktop/MyProjects/MusicFest/client/src/components/Dashboard.js"],"names":["React","useState","useEffect","useStateValue","axios","useHistory","Dashboard","code","history","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","console","log","post","then","res","push","catch","timeOut","setTimeout"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,QAAf,EAAyBC,SAAzB,QAAyC,OAAzC;AACA,SAASC,aAAT,QAA8B,4BAA9B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;;AAEA,eAAe,SAASC,SAAT,CAAmB;AAACC,EAAAA;AAAD,CAAnB,EAA2B;AAAA;;AACtC,QAAMC,OAAO,GAAGH,UAAU,EAA1B;AAEA,QAAM,CAACI,WAAD,EAAcC,cAAd,IAAgCT,QAAQ,EAA9C;AACA,QAAM,CAACU,YAAD,EAAeC,eAAf,IAAkCX,QAAQ,EAAhD;AACA,QAAM,CAACY,SAAD,EAAYC,YAAZ,IAA4Bb,QAAQ,EAA1C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACZa,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBT,IAAvB;AACAH,IAAAA,KAAK,CAACa,IAAN,CAAW,6BAAX,EAA0C;AACtCV,MAAAA;AADsC,KAA1C,EAEGW,IAFH,CAESC,GAAD,IAAS;AACbJ,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBG,GAArB;AACAT,MAAAA,cAAc,CAACS,GAAG,CAACV,WAAL,CAAd;AACAG,MAAAA,eAAe,CAACO,GAAG,CAACR,YAAL,CAAf;AACAG,MAAAA,YAAY,CAACK,GAAG,CAACN,SAAL,CAAZ;AACAL,MAAAA,OAAO,CAACY,IAAR,CAAa,GAAb;AACH,KARD,EAQGC,KARH,CAQS,MAAK;AACVb,MAAAA,OAAO,CAACY,IAAR,CAAa,GAAb;AACH,KAVD;AAWH,GAbQ,EAaN,CAACb,IAAD,CAbM,CAAT;AAeAL,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAG,CAACS,YAAD,IAAgB,CAACE,SAApB,EAAgC;AAChC,UAAMS,OAAO,GAAGC,UAAU,CAAC,MAAM;AAC7BnB,MAAAA,KAAK,CAACa,IAAN,CAAW,+BAAX,EAA4C;AAC5CN,QAAAA;AAD4C,OAA5C,EAEDO,IAFC,CAEKC,GAAD,IAAS;AACbJ,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBG,GAArB;AACAT,QAAAA,cAAc,CAACS,GAAG,CAACV,WAAL,CAAd;AACAK,QAAAA,YAAY,CAACK,GAAG,CAACN,SAAL,CAAZ;AACAL,QAAAA,OAAO,CAACY,IAAR,CAAa,GAAb;AACH,OAPG,EAODC,KAPC,CAOK,MAAK;AACVb,QAAAA,OAAO,CAACY,IAAR,CAAa,GAAb;AACH,OATG;AAUH,KAXyB,EAWvB,CAACP,SAAS,GAAG,EAAb,IAAiB,IAXM,CAA1B;AAaJ;AAEC,GAjBQ,EAiBN,CAACF,YAAD,EAAeE,SAAf,CAjBM,CAAT;AAkBA,sBACI;AAAA;AAAA;AAAA;AAAA,UADJ;AAGH;;GA3CuBP,S;UACJD,U;;;KADIC,S","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport { useStateValue } from '../utilities/StateProvider';\r\nimport axios from 'axios';\r\nimport { useHistory } from \"react-router-dom\"\r\n\r\nexport default function Dashboard({code}) {\r\n    const history = useHistory();\r\n    \r\n    const [accessToken, setAccessToken] = useState()\r\n    const [refreshToken, setRefreshToken] = useState()\r\n    const [expiresIn, setExpiresIn] = useState()\r\n\r\n    useEffect(() => {\r\n        console.log('code is', code)\r\n        axios.post('http://localhost:3001/login', {\r\n            code\r\n        }).then((res) => {\r\n            console.log('res :', res);\r\n            setAccessToken(res.accessToken);\r\n            setRefreshToken(res.refreshToken);\r\n            setExpiresIn(res.expiresIn);\r\n            history.push('/')\r\n        }).catch(() =>{\r\n            history.push('/')\r\n        })\r\n    }, [code])\r\n\r\n    useEffect(() => {\r\n        if(!refreshToken|| !expiresIn ) return\r\n        const timeOut = setTimeout(() => {\r\n            axios.post('http://localhost:3001/refresh', {\r\n            refreshToken\r\n        }).then((res) => {\r\n            console.log('res :', res);\r\n            setAccessToken(res.accessToken);\r\n            setExpiresIn(res.expiresIn);\r\n            history.push('/')\r\n        }).catch(() =>{\r\n            history.push('/')\r\n        })\r\n        }, (expiresIn - 60)*1000)\r\n        \r\n    return \r\n        \r\n    }, [refreshToken, expiresIn])\r\n    return (\r\n        <div></div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}